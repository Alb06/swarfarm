{% extends 'sw_parser/base.html' %}
{% load utils %}

{% block content %}
    <div class="col-md-8 col-md-offset-2">


        <h1>Please review import results. Changes are not applied until you confirm.</h1>

        <h2>Monsters</h2>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active">
                <a href="#updated_mons" aria-controls="updated_mons" role="tab" data-toggle="tab">
                    Updated <span class="badge">{{ monsters.updated.count }}</span>
                </a>
            </li>
            <li role="presentation">
                <a href="#new_mons" aria-controls="new_mons" role="tab" data-toggle="tab">
                    New <span class="badge">{{ monsters.new.count }}</span>
                </a>
            </li>
            <li role="presentation">
                <a href="#missing_mons" aria-controls="missing_mons" role="tab" data-toggle="tab">
                    Missing <span class="badge">{{ monsters.missing.count }}</span>
                </a>
            </li>
        </ul>

        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="updated_mons">
                {% for mon in monsters.updated %}
                    {% include 'sw_parser/monster_thumb.html' with instance=mon only %}
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane" id="new_mons">
                {% for mon in monsters.new %}
                    {% include 'sw_parser/monster_thumb.html' with instance=mon only %}
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane" id="missing_mons">
                {% for mon in monsters.missing %}
                    {% include 'sw_parser/monster_thumb.html' with instance=mon only %}
                {% endfor %}
            </div>
        </div>

        <h2>Runes</h2>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" {% if updated_runes == 0 %}class="disabled"{% else %}class="active"{% endif %}>
                <a href="#updated_runes" aria-controls="updated_runes" role="tab" {% if updated_runes == 0 %}class="disabled" {% else %}data-toggle="tab"{% endif %}>
                    Updated <span class="badge">{{ updated_runes }}</span>
                </a>
            </li>
            <li role="presentation" {% if new_runes == 0 %}class="disabled"{% elif new_runes > 0 and updated_runes == 0 %}class="active"{% endif %}>
                <a href="#new_runes" aria-controls="new_runes" role="tab" {% if new_runes == 0 %}class="disabled" {% else %}data-toggle="tab"{% endif %}>
                    New <span class="badge">{{ new_runes }}</span>
                </a>
            </li>
            <li role="presentation" {% if missing_runes == 0 %}class="disabled"{% elif missing_runes > 0 and updated_runes == 0 and new_runes == 0%}class="active"{% endif %}>
                <a href="#missing_runes" aria-controls="missing_runes" role="tab" {% if missing_runes == 0 %}class="disabled" {% else %}data-toggle="tab"{% endif %}>
                    Missing <span class="badge">{{ missing_runes }}</span>
                </a>
            </li>
        </ul>

        <div class="tab-content">
            <div role="tabpanel" class="tab-pane{% if updated_runes > 0 %} active{% endif %}" id="updated_runes">
                {% for type, runes in runes.updated.iteritems %}
                    {% if type_runes|length > 0 %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <p class="panel-title">{{ type }}</p>
                            </div>
                            <div class="panel-body">
                                {% for rune in runes %}
                                    {% include 'herders/profile/runes/rune_image_fragment.html' with rune=rune popover=True only %}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane{% if updated_runes == 0 and new_runes > 0 %} active{% endif %}" id="new_runes">
                {% for type, type_runes in runes.new.iteritems %}
                    {% if type_runes|length > 0 %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <p class="panel-title">{{ type }}</p>
                            </div>
                            <div class="panel-body">
                                {% for rune in type_runes %}
                                    {% include 'herders/profile/runes/rune_image_fragment.html' with rune=rune popover=True only %}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
            <div role="tabpanel" class="tab-pane{% if updated_runes == 0 and new_runes == 0 and missing_runes > 0 %} active{% endif %}" id="missing_runes">
                {% for type, runes in runes.missing.iteritems %}
                    {% if type_runes|length > 0 %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <p class="panel-title">{{ type }}</p>
                            </div>
                            <div class="panel-body">
                                {% for rune in runes %}
                                    {% include 'herders/profile/runes/rune_image_fragment.html' with rune=rune popover=True only %}
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock content %}