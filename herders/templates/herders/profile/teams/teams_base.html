{% extends 'base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}
{% load crispy_forms_filters %}
{% load utils %}

{% block content %}
    {% static 'herders/images/' as img_url_prefix %}
    <div class="team-list pull-left">
        {% for group in team_groups %}
            <button type="button" class="btn btn-primary" data-toggle="collapse" data-target="#collapse{{ forloop.counter }}">{{ group.name }}</button>
            <div id="collapse{{ forloop.counter }}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                <ul>
                {% for team in group.team_set.all %}
                    <li><a href="#{{ team.pk.hex }}" class="team-link btn btn-default" data-team-id="{{ team.pk.hex }}">{{ team.name }}</a></li>
                {% empty %}
                    <li>Empty! Add a team.</li>
                {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </div>

    <div class="team-detail">
        <div id="team-detail"></div>
    </div>

{% endblock %}

{% block javascript %}
    <script type="text/javascript">
        var team_detail = $('#team-detail');
        var page_content = $('div.content');

        page_content.on('click', 'a.team-link', function() {
            var team_id = $(this).data('team-id');
            team_detail.load('/profile/{{ profile_name }}/teams/detail/' + team_id + '/');
        });

        team_detail.on('click', 'a.team-edit', function() {
            var team_id = $(this).data('team-id');
            team_detail.load('/profile/{{ profile_name }}/teams/edit/' + team_id + '/');
        });

        var hashStr = location.hash.replace("#","");
        if (hashStr) {
            team_detail.load('/profile/{{ profile_name }}/teams/detail/' + hashStr + '/');
        }
    </script>
{% endblock javascript %}